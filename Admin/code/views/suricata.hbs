{{> header title="Admin" }}

<body class="text-center">
  
  {{> nav }}
  
  <div class="container mt-3">
    <div class="col-xl-10 offset-xl-1 text-left">
      
      {{> flash }}
      
      <div class="row mt-3 mb-3">
        <a href="/admin" class="btn confirmed-blue-btn btn-sm">Back to Admin</a>
      </div>
      
      <div class="row mt-3">
        <div class="container-fluid mt-1 p-3 rounded confirmed-bg text-center">
          <h1 class="h5 text-center"><strong>Suricata Rules</strong></h1>
          {{#each ruleFiles}}
            <h5 class="mt-3">{{ this.filename }}</h5>
            {{#if this.error}}
              <p class="mt-1" style="color: red;">{{ this.error }}</p>
            {{/if}}
            <form id="{{ this.filename }}-form" action="/save-rule" method="POST">
              <input type="hidden" id="ruleFile" name="ruleFile" form="{{ this.filename }}-form" value="{{ this.filename }}"/>
              <textarea rows="10" type="text" id="ruleContent" name="ruleContent" form="{{ this.filename }}-form" placeholder="Rule Text" class="text-left form-control mb-2">{{ this.content }}</textarea>
              <button id="{{ this.filename }}Button" type="submit" class="btn confirmed-blue-btn text-white" style="margin-left: auto; margin-right: auto;">Save Rule</button>
            </form>
          {{/each}}
        </div>
      </div>
  
    </div> <!-- column -->
  </div> <!-- row -->
  
  {{> footer}}

  {{> bootstrapjs}}
  
</body>